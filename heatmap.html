<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Commit Heatmap</title>
<style>
    #map {
		//position:absolute;
		//margin-left:500px;
        width:500px;
        height:600px;
		//border:1px solid black;
    }
	
	#wrapper{
		position: relative;
		width:800px;
		margin:0 auto;	
	}

    #district-tooltip {
        display: none;
        position: absolute;
        padding: 5px 20px 5px 20px;
        border: #cccccc 1px solid;
        background-color: #ffffff;
        text-align: center;
        opacity: 0.9;
        border-radius: 4px;
        font-size: 14px;
		z-index:10;
    }
	
#table_selector{
		position: relative;
		//left:50%;
		margin-left:150px;
		width:300px;	
		margin-top:10px;
	}
	#field_selector{
		position: relative;
		//left:50%;
		margin-left:50px;
		width:500px;	
		margin-top:10px;
	}
	
	#logo{
		margin-left:10px;
		margin-top:10px;	
	}
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="district-map.js"></script>
<script src="Mappings.js"></script>
<script src="selectMapping.js"></script>
<link href="bootstrap/css/bootstrap.css" rel="stylesheet"/>

<script>
//createMap(selectedTable, "DPFEAALLT");

$(document).ready(function(e) {
	//fill selections
	//getData
	
	//create
	
	function Initialize()
	{
	selectedTable="Financial";
	selectedField="DPFEAADCK";
	fillSelect();
	$('#table_selector').val("Financial");
	$('#field_selector').val("District 2011 Finance: Expenditure by Function-Central Administration Per Pupil, All Funds");
			$.ajax({
			url: "http://commit.azurewebsites.net/api/Financial",
			dataType: 'json',
			success: function (results) {
					MyData=[];
					$.each(results, function(i, key){
						MyData.push(results[i]);	
					});
					//reverseLookup($('#field_selector').val(), selectMapping[selectedTable]);
					createMap(selectedTable, selectedField);
			}
		});
	}
	

	Initialize();
	
	
	$('#table_selector').change(function() {
		selectedTable=$('#table_selector').val();
		console.log(selectedTable);
  		fillSelect();
		getData();
		
		//createMap(selectedTable, selectedField);
	});  
	
	
	$('#field_selector').change(function() {
		var theMapper= $('#table_selector').val();
		reverseLookup($('#field_selector').val(), selectMapping[theMapper]);
  		createMap(selectedTable, selectedField);
	});  
});

			var MyData=[];
			var selectedTable;
			var selectedField;
			

            function getData()
            {
	            $.ajax({
	                url: "http://commit.azurewebsites.net/api/"+selectedTable,
	                dataType: 'json',
	                success: function (results) {
	                        MyData=[];
		                   	$.each(results, function(i, key){
			            		MyData.push(results[i]);	
			            	});
			            	reverseLookup($('#field_selector').val(), selectMapping[selectedTable]);
	         				//createChart();
	                }
	            });
				
				createMap(selectedTable, selectedField);
	            
            	
            }

			function reverseLookup(value, mapping)
			{
				$.each(mapping, function(i, key){
					if(mapping[i]==value)
					{
						selectedField=i;
					}
				});
				return;
			}
	
			function fillSelect()
            {
            	var mapper = selectedTable;
				$('#field_selector').html('');
        	    $.each(selectMapping[mapper], function(key, value) {   
				     $('#field_selector')
						    .append('<option>'+value+'</option>')
				});	
				
				$('#field_selector').prop('selectedIndex', 1);
				reverseLookup($('#field_selector').val(), selectMapping[selectedTable]);
            }

			

</script>
</head>

<body>
<image id="logo" src="commit_logo.png"/>
<div id="district-tooltip"></div>
<div id="wrapper">
        <select id="table_selector" data-bind="value: selectedTable">
            <option value="Staff">Staff</option>
            <option value="CollegeReady">CollegeReady</option>
            <option value="Student">Student</option>
            <option value="Financial">Financial</option>
            <option value="Completion">Completion</option>
            <option value="NonTaks">NonTaks</option>
            <option value="TaksStandard">TaksStandard</option>
            <option value="TaksCommended">TaksCommended</option>
            <option value="TaksFailures">TaksFailures</option>
            <option value="TaksModified">TaksModified</option>
            <option value="TaksBilingual">TaksBilingual</option>
        </select>

<select id="field_selector">   
</select>


<svg id="map" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <path id="DALLAS-ISD" fill="#FFFFFF" stroke="#1E1E1E" stroke-opacity="0.5" d="M284.896,194.395l1.458,25.979l11.997-0.211l0.104,5.999
        l-3,0.053l0.036,2l-1.999,0.035l-0.86,8.016l7.034,1.877l-0.965,2.016l-11.997,0.21l0.122,6.999l1.019,0.983l12.997-0.229l-0.018-1
        l3-0.053l1.069,3.982l1.001-0.017l0.053,2.999l2.017,0.965l-5.913,5.105l6.999-0.123l5.072,3.911l4.122,6.928l4.156,8.928
        l3.034,1.949l-0.965,2.016l8.104,5.859l3.141,7.946l3.946-3.07l3.141,7.946l4.912-5.087l4.052,2.929l0.947-3.018l2.035,1.965
        l14.997-0.264l-0.229-12.997l18.998-0.334l0.333,18.997l12.998-0.228l-0.966,2.019l10.156,8.822l-9.085-4.841l-3.894,6.069
        l4.069,3.93l-2.947,3.051l-2.035-1.964l-2.947,3.052l1.193,10.98l-2.999,0.053l0.105,5.999l-2,0.036l0.123,6.999l-2.999,0.053
        l0.21,11.999l-6.999,0.123l9.157,8.84l0.069,3.999l3-0.053l10.175,9.824l0.052,3l12.208,11.787l0.439,24.997l12.998-0.229
        l0.175,9.998l5.999-0.105l0.089,5.001l11.015,0.805l3.053,2.947l0.982-1.017l4.069,3.928l-1.981,1.035l6.104,5.895l0.088,5l8-0.141
        l4.91-5.087l9.157,8.841l2.998-0.053l5.912-5.105l4.122,6.928l-1.944,3.035l5.137,7.912l0.756,100.003l-86.005,0.508l-13.401-22.768
        l-10.893,6.191l5.105,5.911l1.052,2.982l-1.982,1.036l-5.052-2.913l-3.964,2.071l-2.001,0.035l-4.051-2.93l-5.998,0.105l-1.02-0.983
        l-5.979,1.105l-2.072-3.964l-3.016-0.946l-5.069-3.912l1.911-5.034l2.981-1.054l-1.053-2.981l2.966-2.052l-1.334-18.98l-4,0.07
        l-0.21-11.996l-12.997,0.228l-0.123-7l-3.982,1.071l-2.017-0.965l-0.896,6.015l0.896-6.015l-8.999,0.158l-3.088-4.947l-14.856,8.262
        l-6.192-10.893l-0.981,1.018l-3.104-5.947l4.944-3.087l-6.174-9.894l-6.929,4.122l0.053,3l-11.998,0.21l0.439,24.996l-37.977,1.668
        l-10.033-1.824l0.945-3.019l-2.017-0.962l10.999-0.193l-0.123-7l-2.999,0.053l-0.212-11.999l3.999-0.07l-0.122-6.999l-12.998,0.229
        l-0.334-18.998l5.999-0.104l-0.21-11.998l-5.999,0.104l-0.035-1.998l-4,0.068l-1.017-0.982l-7.999,0.143l-0.175-10l-30.996,0.545
        l0.369,20.996l6.016,0.896l0.054,2.998l-18.997,0.333l1.824-10.032l2.999-0.053l-0.122-7l6.84-9.121l0.895-6.017l6.894-6.122
        l7.999-0.14l-0.192-10.999l2.859-8.052l-2,0.034l0.964-2.016l0.982-1.018l1.771-13.033l-1.018-0.982l1.018,0.982l5.912-5.104
        l-0.053-3l1.947-3.034l-0.071-3.999l-6.051-2.895l0.964-2.017l3.999-0.07l2.912-5.052l5-0.087l-1.036-1.982l0.966-2.017l8.033,1.859
        l0.054,3l3.964-2.07l3.034,1.947l-1.369-20.979l-14.015-0.753l-0.07-4l8.823-10.157l0.755-14.015l-3.018-0.947l-0.035-2l-3,0.052
        l-1.052-2.981l-0.982,1.017l-5.052-2.912l-2.982,1.052l-1.053-2.981l-1.964,2.035l-1.036-1.982l-1.981,1.035l-4.035-1.929
        l2.982-1.053l-3.034-1.947l0.965-2.018l-2,0.036l0.912-5.017l-2.981,1.052l-1.035-1.982l1.842-9.034l-3.035-1.946l0.981-1.019
        l12.998-0.228l4.509-28.084l7.998-0.14l1.054,2.981l1.998-0.036l0.018,1.001l7.001-0.123l-0.019-1l1.982-1.034l1.034,1.981l3-0.054
        l-0.281-15.998l6.018,0.896l0.104,5.999l18.979-1.334l-0.228-12.997l-11.999,0.21l-0.42-23.997l-6.001,0.105l-1.297-16.979
        L284.896,194.395 M306.736,299.028l-23.996,0.422l-3.334,38.065l2.035,1.963l0.948-3.017l5.982-1.105l4.068,3.93l0.93-4.018
        l4.017,0.93l7.842-9.139l-0.053-3l2-0.035L312,313.938l0.894-6.016l-0.034-2l-6,0.104L306.736,299.028"/>
    <path id="GRAND-PRAIRIE-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M124.256,330.236l3.018,0.947l3.14,7.945l5.068,3.913l1.124,6.98
        l2.069,3.964l11.998-0.21l0.299,16.998l8.016,0.858l-0.034-1.999l4.052,2.929l0.352,19.997l3.964-2.07l1.877-7.035l2.982-1.051
        l3.018,0.947l-1.036-1.983l4.999-0.087l-1.052-2.981l3.964-2.07l1-0.018l-1.947,3.034l4.98-1.087l2.054,2.964l0.929-4.016
        l1.019,0.982l1.034,1.983l2.018,0.964l0.07,4l4.017,0.929l1.088,4.982l4.824-10.087l1.999-0.035l-0.93,4.018l3.018,0.947
        l-1.946,3.034l-3.983,1.071l1.018,0.982l-1.771,13.033l-0.982,1.018l-0.964,2.016l2-0.034l-2.859,8.052l0.192,10.999l-7.999,0.14
        l-4.929,4.088l-1.965,2.034l-0.895,6.017l-6.84,9.121l0.122,7l-2.999,0.053l-1.824,10.032l-5,0.089l-2.859,8.051l-4.911,5.087
        l3.018,0.948l-1.911,5.033l-2.948,3.053l4.123,6.928l-15.823,10.28l-0.964,2.017l-6.017-0.895l-10.911,5.193l1.053,2.98
        l-5.945,3.106l-0.283-187.024L124.256,330.236"/>
    <path id="IRVING-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M135.166,268.036l0.088,5l8.997-0.159l0.158,8.999l11.999-0.21l0.053,3
        l-2,0.036l0.246,13.997l22.997-0.403l-0.194-10.999l15.997-0.281l-0.21-11.998l3.999-0.069l1.035,1.981l-2.964,2.052l1.035,1.982
        l-1.947,3.036l3.035,1.946l-1.842,9.034l1.035,1.982l2.981-1.052l-0.912,5.017l2-0.036l-0.965,2.018l3.034,1.947l-2.982,1.053
        l4.035,1.929l1.981-1.035l1.036,1.982l1.964-2.035l1.053,2.981l2.982-1.052l5.052,2.912l0.982-1.017l1.052,2.981l3-0.052l0.035,2
        l3.018,0.947l-0.755,14.015l-8.823,10.157l0.07,4l14.015,0.753l1.369,20.979l-3.034-1.947l-3.964,2.07l-0.054-3l-8.033-1.859
        l-0.966,2.017l1.036,1.982l-5,0.087l-2.912,5.052l-3.999,0.07l-0.964,2.017l6.051,2.895l-1.823,10.033l-4.018-0.929l0.947-3.018
        l-2.034-1.964l-4.807,11.086l-1.088-4.982l-4.017-0.929l-0.07-4l-2.018-0.964l-1.034-1.983l-1.019-0.982l-0.929,4.016l-2.054-2.964
        l-4.98,1.087l1.947-3.034l-1,0.018l-3.964,2.07l1.052,2.981l-4.999,0.087l1.036,1.983l-3.018-0.947l-2.982,1.051l-1.877,7.035
        l-3.964,2.07l-0.352-19.997l-4.052-2.929l0.034,1.999l-8.016-0.858l-0.299-16.998l-11.998,0.21l-2.069-3.964l-1.124-6.98
        l-5.068-3.913l-3.14-7.945l-6.034-1.895l-0.07-61.008L135.166,268.036"/>
    <path id="COPPELL-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M186.964,199.115l4.034,1.931l-2.964,2.051l2.018,0.965l-0.947,3.018
        l-8.999,0.158l0.07,4l-5.999,0.105l-0.632,21.015l2.999-0.053l0.071,3.999l3-0.053l0.192,10.999l-15.997,0.281l0.14,7.999
        l-6.98,1.123l-0.562,25.013l-11.999,0.21l-0.158-8.999l-8.997,0.159l-0.088-5l-13.997,0.245l-0.246-13.998l8.998-0.159
        l-0.245-13.997l-1,0.018l-0.176-9.999l-7.999,0.141l-0.632-35.995l66.008-0.158L186.964,199.115"/>
    <path id="CARROLLTON-FARMERS-BRANCH-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M247.463,170.048l0.053,3l8.999-0.158l0.369,20.998l-14.998,0.263
        l1.297,16.979l6.001-0.105l0.42,23.997l11.999-0.21l0.228,12.997l-18.979,1.334l-0.104-5.999l-6.018-0.896l0.281,15.998l-3,0.054
        l-1.034-1.981l-1.982,1.034l0.019,1l-7.001,0.123l-0.018-1.001l-1.998,0.036l-1.054-2.981l-7.998,0.14l-4.509,28.084l-12.998,0.228
        l-0.069-3.999l2.964-2.052l-1.035-1.981l-3.999,0.069l0.21,11.998l-15.997,0.281l0.194,10.999l-22.997,0.403l-0.246-13.997l2-0.036
        l-0.211-11.998l1-0.018l-0.28-15.998l6.98-1.123l-0.14-7.999l15.997-0.281l-0.192-10.999l-3,0.053l-0.071-3.999l-2.999,0.053
        l0.632-21.015l5.999-0.105l-0.07-4l8.999-0.158l0.947-3.018l-2.018-0.965l2.964-2.051l-4.034-1.931l-1.087-4.981l10.998-0.193
        l-1.246-13.979l8.999-0.159l-0.104-5.999l5.998-0.105l-0.069-4l6.999-0.123l0.017,1l23.996-0.421l-0.053-3l6-0.105L247.463,170.048"
        />
    <path id="HIGHLAND-PARK-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M306.736,299.028l0.123,6.999l6-0.104l0.034,2L312,313.938
        l-4.824,10.087l-2,0.035l0.053,3l-7.842,9.139l-4.017-0.93l-0.93,4.018l-4.068-3.93l-5.982,1.105l-0.948,3.017l-2.035-1.963
        l3.334-38.065L306.736,299.028"/>
    <path id="RICHARDSON-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M387.897,193.588l0.158,8.999l-3.981,1.07l0.193,10.998l-8.999,0.157
        l0.562,31.997l-12.999,0.228l0.352,19.996l5.947-3.104l0.614,34.995l-14.997,0.264l-2.035-1.965l-0.947,3.018l-4.052-2.929
        l-4.912,5.087l-3.141-7.946l-3.946,3.07l-3.141-7.946l-8.12-6.859l0.981-1.016l-3.034-1.949l-4.156-8.928l-4.122-6.928l-5.072-3.911
        l-6.999,0.123l5.913-5.105l-2.017-0.965l-0.053-2.999l-1.001,0.017l-1.069-3.982l-3,0.053l0.018,1l-12.997,0.229l-1.141-7.982
        l11.997-0.21l0.965-2.016l-7.034-1.877l0.86-8.016l1.999-0.035l-0.036-2l3-0.053l-0.104-5.999l-11.997,0.211l-1.458-25.979
        L387.897,193.588"/>
    <path id="GARLAND-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M491.916,193.761l4-0.069l0.283,130.015l-30.013-0.474l-4.932,4.088
        l-3.05-2.947l-4.999,0.088l-5.982,1.105l-7.018-0.877l-4.05-2.93l-1.034-1.981l0.963-2.018l-12.192-10.788l-2.946,3.053
        l-2.035-1.965l-10.785,12.191l-4.966,2.087l-5.104-5.912l3.894-6.069l8.104,5.859l-0.019-1l-9.157-8.839l0.966-2.019l-12.998,0.228
        l-0.333-18.997l-18.998,0.334l-0.386-21.998l-5.947,3.104l-0.352-19.996l12.999-0.228l-0.562-31.997l8.999-0.157l-0.193-10.998
        l3.981-1.07l-0.158-8.999L491.916,193.761"/>
    <path id="MESQUITE-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M426.946,309.919l9.139,7.841l-0.963,2.018l1.034,1.981l4.05,2.93
        l0.229,12.998l-0.947,3.018l-4.982,1.086l-0.894,6.017l4.999-0.087l0.141,8l14.016,0.753l0.245,13.998l7.017,0.877l0.211,11.998
        l17.032,1.702l19.12,6.666l0.421,81.005l-5.137-7.912l1.944-3.035l-4.122-6.928l-5.912,5.105l-2.998,0.053l-9.157-8.841l-4.91,5.087
        l-8,0.141l-0.088-5l-6.104-5.895l1.981-1.035l-4.069-3.928l-0.982,1.017l-3.053-2.947l-11.015-0.805l-0.089-5.001l-5.999,0.105
        l-0.175-9.998l-12.998,0.229l-0.439-24.997l-12.208-11.787l-0.052-3l-10.175-9.824l-3,0.053l-0.069-3.999l-9.157-8.84l6.999-0.123
        l-0.21-11.999l2.999-0.053l-0.123-6.999l2-0.036l-0.105-5.999l2.999-0.053l-1.193-10.98l2.947-3.052l2.035,1.964l2.947-3.051
        l1.034,1.981l4.966-2.087l10.785-12.191l2.035,1.965l2.946-3.053L426.946,309.919"/>
    <path id="SUNNYVALE-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M496.199,323.707l0.193,68.007l-19.12-6.666l-17.032-1.702l-0.211-11.998
        l-7.017-0.877l-0.245-13.998l-14.016-0.753l-0.141-8l-4.999,0.087l0.894-6.017l4.982-1.086l0.947-3.018l-0.229-12.998l7.018,0.877
        l5.982-1.105l4.999-0.088l3.05,2.947l4.932-4.088L496.199,323.707"/>
    <path id="LANCASTER-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M298.145,493.209l3.104,5.947l0.981-1.018l6.192,10.893l14.856-8.262
        l3.088,4.947l8.999-0.158l-0.896,6.015l0.896-6.015l2.017,0.965l3.982-1.071l0.123,7l12.997-0.228l0.21,11.996l4-0.07l1.334,18.98
        l-2.966,2.052l1.053,2.981l-2.981,1.054l-1.911,5.034l5.069,3.912l3.016,0.946l7.211,11.875l-5.946,3.104l-83.005,0.459
        l-1.527-86.988l11.998-0.21l-0.053-3l6.929-4.122l6.174,9.894L298.145,493.209"/>
    <path id="DESOTO-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M276.479,512.592l2.036,1.965l1.053,59.992l-55.991,0.983l-0.421-23.997
        l-6,0.106l-0.438-24.999l11.998-0.21l-0.088-5l2.947-3.052l4-0.069l1.963-2.036l-2.034-1.964L276.479,512.592"/>
    <path id="CEDAR-HILL-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"   d="M167.357,506.506l3.068,3.947l9.876-7.174l3.07,3.946l7.017,0.877
        l-0.053-3l7.104,5.877l2.947-3.052l2.999-0.053l0.105,5.998l5.999-0.105l0.229,12.998l6.999-0.123l0.438,24.999l6-0.106
        l0.421,23.997l-101.003,0.771l-1.052-59.99l5.945-3.106l-1.053-2.98l10.911-5.193l6.017,0.895l0.964-2.017l15.823-10.28
        L167.357,506.506"/>
    <path id="DUNCANVILLE-ISD" fill-opacity="0" stroke="#1E1E1E" stroke-opacity="0.5"  d="M214.174,438.674l0.175,10l7.999-0.143l1.017,0.982l4-0.068
        l0.035,1.998l5.999-0.104l0.21,11.998l-5.999,0.104l0.334,18.998l12.998-0.229l0.122,6.999l-3.999,0.07l0.212,11.999l2.999-0.053
        l0.123,7l-10.999,0.193l2.017,0.962l-0.945,3.019l7.067,3.875l-1.963,2.036l-4,0.069l-2.947,3.052l0.088,5l-18.997,0.333
        l-0.229-12.998l-5.999,0.105l-0.105-5.998l-2.999,0.053l-2.947,3.052l-7.104-5.877l0.053,3l-7.017-0.877l-3.07-3.946l-9.876,7.174
        l-14.419-23.75l3.93-4.07l0.93-4.016l-3.018-0.948l4.911-5.087l2.859-8.051l23.997-0.422l-0.054-2.998l-6.016-0.896l-0.369-20.996
        L214.174,438.674"/>
</svg>

</div>


<script src="bootstrap/js/bootstrap.min.js"></script>
</body>
</html>
